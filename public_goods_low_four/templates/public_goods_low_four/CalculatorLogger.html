<!-- Calculator Data Logger - Sends localStorage data to server via liveSend -->
<script>
$(document).ready(function() {
    // Send calculator data when FinalResult page loads
    var participantCode = window.location.pathname.split('/')[2];
    var sessionCode = $('#session-code').text();
    var gameType = window.location.pathname.split('/')[3];
    var pageKey = 'calculator_logs_' + gameType + '_' + sessionCode + '_' + participantCode;

    console.log('[Calculator Logger] Looking for key:', pageKey);

    var logs = localStorage.getItem(pageKey) || '[]';
    var count = JSON.parse(logs).length;
    console.log('[Calculator Logger] Found', count, 'calculator submissions');

    // Send calculator data to server via liveSend
    if (typeof liveSend === 'function') {
        liveSend({'calculator_data': logs});
        console.log('[Calculator Logger] Data sent to server via liveSend');
    } else {
        console.error('[Calculator Logger] liveSend function not available');
    }
});
</script>
