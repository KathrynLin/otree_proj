
<script src="https://code.highcharts.com/highcharts.js"></script>

<div id='calculator' style="position: fixed; width: 250px; height: auto; max-height: 800px; overflow-y: auto; padding:30px; right:20px; bottom:20px; z-index:999; border-radius: 20px; border: 2px solid #73AD21; box-sizing: border-box; line-height: 1.2;">
    Member 1's investment <input id='member1'><br>
    Member 2's investment <input id='member2'><br>
    Member 3's investment <input id='member3'><br>
    Member 4's investment <input id='member4'><br>
    Member 5's investment <input id='member5'><br>
    Member 6's investment <input id='member6'><br>
    Member 7's investment <input id='member7'><br>
    Member 8's investment <input id='member8'><br>
    Member 9's investment <input id='member9'><br>
    Your investment <br><input id='myinvestment'><br>
    <button id='cal'>Submit</button><br>
    Your earnings from the group account: <p id='group_income'>_______</p>
    Your earnings from the private account: <p id='private_income'>_______</p>
    Your total earnings:<p id='total_income'>_______</p>

</div>

<div>


  <script>
  $( document ).ready(function() {
    //
    // $('#sure').click(function(event){
    //   event.preventDefault();
    //   var x = $('#myText1st').val();
    //   var y = $('#myText2nd').val();
    //   x=parseInt(x);
    //   y=parseInt(y);
    //   $('#calculator').text(x+y);
    // });

    //calculater results
    $('#cal').click(function(event){
      event.preventDefault();
      console.log('[Calculator Quiz] Submit button clicked');
      var member1 = $('#member1').val();
      var member2 = $('#member2').val();
      var member3 = $('#member3').val();
      var member4 = $('#member4').val();
      var member5 = $('#member5').val();
      var member6 = $('#member6').val();
      var member7 = $('#member7').val();
      var member8 = $('#member8').val();
      var member9 = $('#member9').val();
      var my = $('#myinvestment').val();
      console.log('[Calculator Quiz] Values:', {member1, member2, member3, member4, member5, member6, member7, member8, member9, my});

      // Save calculator data to page-specific localStorage key
         var dataPackage = {
           member1 : member1,
           member2 : member2,
           member3 : member3,
           member4 : member4,
           member5 : member5,
           member6 : member6,
           member7 : member7,
           member8 : member8,
           member9 : member9,
           my : my,
           timestamp : new Date().toISOString(),
           url : window.location.href
         };

         // Determine which page we're on and use appropriate localStorage key
         var participantCode = window.location.pathname.split('/')[2];
         var sessionCode = $('#session-code').text();
         var currentPage = window.location.pathname.split('/').slice(-2,-1)[0]; // e.g., "Introduction", "Question", "Feedback"
         var pageKey = 'calc_' + currentPage.toLowerCase().substring(0,8) + '_' + sessionCode + '_' + participantCode;

         var calculatorLogs = JSON.parse(localStorage.getItem(pageKey) || '[]');

         // Check if values have changed from the last submission
         var shouldSave = true;
         if (calculatorLogs.length > 0) {
             var lastLog = calculatorLogs[calculatorLogs.length - 1];
             if (lastLog.member1 === member1 &&
                 lastLog.member2 === member2 &&
                 lastLog.member3 === member3 &&
                 lastLog.member4 === member4 &&
                 lastLog.member5 === member5 &&
                 lastLog.member6 === member6 &&
                 lastLog.member7 === member7 &&
                 lastLog.member8 === member8 &&
                 lastLog.member9 === member9 &&
                 lastLog.my === my) {
                 shouldSave = false;
             }
         }

         // Only save if values have changed
         if (shouldSave) {
             calculatorLogs.push(dataPackage);
             localStorage.setItem(pageKey, JSON.stringify(calculatorLogs));
             console.log("[Calculator]", currentPage, "saved. Total:", calculatorLogs.length);
         }


      var rho = 0.7;
      var beta = 0.4;
      if (member1*member2*member3*member4*member5*member6*member7*member8*member9*my == 0){
        var income_from_group = NaN;
        var income_from_private = NaN;
        var total_income = NaN
      }else{
        var income1 = beta*Math.pow((Math.pow(member1, rho)
                          + Math.pow(member2, rho)
                          + Math.pow(member3, rho)
                          + Math.pow(member4, rho)
                          + Math.pow(member5, rho)
                          + Math.pow(member6, rho)
                          + Math.pow(member7, rho)
                          + Math.pow(member8, rho)
                          + Math.pow(member9, rho)
                          + Math.pow(my, rho)), (1/rho));
        var income2 = 10-my;
        var income3 = income1 + income2;
        var income_from_group = income1.toFixed(2);
        var income_from_private = income2.toFixed(2);
        var total_income = income3.toFixed(2);
      }

      $('#group_income').html('___'+income_from_group+'____')
      $('#private_income').html('___'+income_from_private+'____')
      $('#total_income').html('___'+total_income+'____')
    });


    $('#container2').highcharts({
        legend: {
            enabled: false
        },
        title: {
            text: 'Your total earnings when everyone else invests 1 point',
            x: -20 //center
        },
        xAxis: {
            title: {
                text: 'Your investment level x'
            },
            tickInterval: 2
        },
        yAxis: {
            title: {
                text: 'Your total earnings y'
            },
            min:17,
            max:20,
            tickInterval: 1
        },

        tooltip: {
            pointFormat: 'x = {point.x}, y = {point.y}'
        },
        series: [{
            data: [19.73, 19.70, 19.55, 19.33, 19.06, 18.77, 18.45, 18.11, 17.75, 17.37],
            pointStart: 1
        }]
    });

    $('#container3').highcharts({
        legend: {
            enabled: false
        },
        title: {
            text: 'Your total earnings when everyone else invests 5 points',
            x: -20 //center
        },
        xAxis: {
            title: {
                text: 'Your investment level x'
            },
            tickInterval: 2
        },
        yAxis: {
            title: {
                text: 'Your total earnings y'
            },
            min:57,
            max:59,
            tickInterval: 0.5
        },

        tooltip: {
            pointFormat: 'x = {point.x}, y = {point.y}'
        },
        series: [{
            data: [57.55, 58.06, 58.36, 58.55, 58.65, 58.70, 58.70, 58.66, 58.60, 58.50],
            pointStart: 1
        }]
    });

    $('#container4').highcharts({
        legend: {
            enabled: false
        },
        title: {
            text: 'Your total earnings when everyone else invests 10 points',
            x: -20 //center
        },
        xAxis: {
            title: {
                text: 'Your investment level x'
            },
            tickInterval: 2
        },
        yAxis: {
            title: {
                text: 'Your total earnings y'
            },
            min:104,
            max:108,
            tickInterval: 1
        },

        tooltip: {
            pointFormat: 'x = {point.x}, y = {point.y}'
        },
        series: [{
            data: [104.25, 105.10, 105.69, 106.12, 106.46, 106.73, 106.93, 107.10, 107.22, 107.31],
            pointStart: 1
        }]
    });

  });
  </script>
</div>

<!-- Write your comments here -->

<!-- <div class="box effect7"> -->
<h3>Instructions</h3>
<p>
    This is an experiment in the economics of decision making. In this experiment, you will be asked to make investment decisions. The amount of money you earn will depend on the decisions you make and on the decisions other people make. Please do not communicate with other people during the experiment. If you have questions at any point during the experiment, raise your hand and the experimenter will help you.
</p>

<p>
    All transactions during the experiment will be calculated in terms of points: every 8 points equals 1 dollar in cash (8 points = $1). For example, if you earn 16 points during this session, you will be paid 2 dollars in cash at the end of the experiment. If your total earnings do not equal an integer, it will be rounded towards the nearest integer.
</p>

<p>
    The experiment will consist of three parts: the review questions, the investment game, and the survey. The total amount of points you earn during the session will be the sum of points you earn from each of the three parts:

<ol type="1">
  <li> At the end of the instructions, you will be asked to complete a set of review questions. You will get 1.6 points ($0.2) for every question you answer correctly.</li>
  <li> The investment game will consist of 20 rounds. At the end of the experiment, the computer will randomly select 1 round out of the 20 that you will get paid for. Each round is equally likely to be selected for payment.</li>
  <li> A lottery game will determine your payment from the final part of the experiment.</li>
</ol>

<h4>The Investment Game</h4>
<p>
    The investment game consists of 20 rounds. At the beginning of each round, you will be randomly matched with 9 other participants to form a group of 10. The composition of the groups will change every round. You will not be informed of the identity of the other group members. At the beginning of the round, each participant will receive 10 points. You will decide how to divide 10 points between two investment opportunities. The return from the group account depends on the actions of your fellow group members. While the return from the private account depends only on your choices. You can invest any integer amount between 0 and 10 points, inclusive, in the group account. Meanwhile, other group members will independently make similar decisions. No one will be informed of the others’ decisions until everyone submits his or her decision.
</p>


<h4>At the end of each round</h4>
<p>
    At the end of each round (after all choices are submitted), you will see:
    <ol, type = "i">
      <li> Your investment decision </li>
      <li> The investment decisions of the other members in your group </li>
      <li> Your earnings</li>
  </ol>
</p>
<p>
    Then the next round will start. You will be randomly matched with another nine participants and receive a new endowment of 10 points.
</p>

<h4>Earnings calculation</h4>

<p>
   Your total earnings will be the sum of the earnings from your private account and 10% of the group account:
</p>


<ol>
   <li> Earnings from the private account: You will earn 1 point for every point you keep in the private account. For example, if you keep 5 points in the private account, your earnings from the private account will be 5 points.
   <li> Earnings from the group account: The earnings from the group account will depend on the investments of all group members, and will be shared equally among the group members. Each group member will receive 10 percent (1/10) of the total return from the group account. The exact earnings earned from the group account can be accessed through the <strong>calculator</strong> on the bottom right corner of the screen.
</ol>

<h4>Using the calculator to compute your earnings</h4>
<p>
   The calculator on the bottom right of the screen can help you calculate your earnings. To activate the calculator, simply fill in a hypothetical value for your own investment and for other group members’ investments in the group account. The calculator will then display your earnings from the group account, your earnings from the private account, and your total earnings.
</p>

<h4>Here are some facts about earnings from the group account:</h4>
<ol>
 <li> The more you and others invest, the higher the return will be.
  <li> Consider two levels for your investment in the group account, low investment and high investment. Next, increase both the low and the high investment by 1 point. The total return will increase in both cases; however, the increase is smaller in the case of the higher investment level.
  <li> When you increase your investment in the group account, the total return will not increase at a constant rate. The rate of increase depends on all group members’ investment levels in the group account.
  <li> For the same average investment in the group account, the total return will be higher if everyone invests similar amounts in the group account.
  <li> In general, it is a good idea to use the calculator to understand exactly what your earnings will be based on different investment scenarios.
 <h4>Examples: we will go through three examples to illustrate how the investment game works. Please take five minutes to go through the examples at your own pace.</h4>
 <ul>
  <li> <strong>The first example demonstrates the special case when everyone else invests 1 point in the group account. </strong>
     <ol>
       <li> If everyone else in your group invests 1 point in the group account, and you invest 1 point, the total return from the group account would be 107.31 points. As a result, your earnings from the group account would be 10.73 points (10 percent of the total return). Your earnings from the private account would be 9 points, and your total earnings would be 19.73 points.
       <li> If everyone else in your group invests 1 point in the group account, and you invest 5 points, the total return from the group account would be 140.65 points. As a result, your earnings from the group account would be 14.06 points (10 percent of the total return). Your earnings from the private account would be 5 points, and your total earnings would be 19.06 points.
       <li> If everyone else in your group invests 1 point in the group account, and you invest 10 points, the total return from the group account would be 173.74 points. As a result, your earnings from the group account would be 17.37 points (10 percent of the total return). Your earnings from the private account would be 0 points, and your total earnings would be 17.37 points.
     </ol>

     <p>The following graph shows your total earnings if you invest X points when everyone else in your group invests 1 points.
        Move your mouse on the graph to see the exact numbers.</p>
         <div id="container2" style="width: 600px; height: 400px"></div>

 <li> <strong>The second example demonstrates the special case when everyone else invests 5 points in the group account. </strong>
    <ol>
      <li> If everyone else in your group invests 5 points in the group account, and you invest 1 points, the total return from the group account would be 485.50 points. As a result, your earnings from the group account would be 48.55 points (10 percent of the total return). Your earnings from the private account would be 9 points, and your total earnings would be 57.55 points.
      <li> If everyone else in your group invests 5 points in the group account, and you invest 5 points, the total return from the group account would be 536.54 points. As a result, your earnings from the group account would be 53.65 points (a quarter of the total return). Your earnings from the private account would be 5 points, and your total earnings would be 58.65 points.
      <li> If everyone else in your group invests 5 points in the group account, and you invest 10 points, the total return from the group account would be 585.04 points. As a result, your earnings from the group account would be 58.50 points (10 percent of the total return). Your earnings from the private account would be 0 points, and your total earnings would be 58.50 points.
    </ol>
<p>The following graph shows your total earnings if you invest x points when everyone else in your group invests 5 points in the group account.</p>
<div id="container3" style="width: 600px; height: 400px"></div>

<li> <strong>The third example demonstrates the special case when everyone else invests 10 points in the group account. </strong>
   <ol>
     <li> If everyone else in your group invests 10 points in the group account, and you invest 1 points, the total return from the group account would be 952.51 points. As a result, your earnings from the group account would be 95.25 points (10 percent of the total return). Your earnings from the private account would be 9 points, and your total earnings would be 104.25 points.
     <li> If everyone else in your group invests 10 points in the group account, and you invest 5 points, the total return from the group account would be 1014.63 points. As a result, your earnings from the group account would be 101.46 points (10 percent of the total return). Your earnings from the private account would be 5 points, and your total earnings would be 106.46 points.
     <li> If everyone else in your group invests 10 points in the group account, and you invest 10 points, the total return from the group account would be 1073.08 points. As a result, your earnings from the group account would be 107.31 points (10 percent of group earnings). Your earnings from the private account would be 75 points, and your total earnings would be 107.31 points.
   </ol>
<p>The following graph shows your total earnings if you invest x points when everyone else in your group invests 10 points in the group account.</p>
<div id="container4" style="width: 600px; height: 400px"></div>
</ul>

<p>
Note that even though in all three examples we assume that everyone else in your group invests the same amount in the group account, in the actual game, they might invest different amounts in the group account.
</p>

<p>
Keep in mind that other people in your group face the same problem as you. Their earnings from the group account and private account follows the same rule as yours.
</p>

<p>
When you finish reading, click on the "next" button on the screen and proceed to the review questions. Please raise your hand if you have any questions.
</p>


<p>
For your convenience, these instructions will remain available to you on all subsequent screens of this study.
</p>
<!-- Write your comments here -->

<!-- </div> -->
