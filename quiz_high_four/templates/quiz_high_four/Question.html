{% extends "global/Base.html" %}
{% load staticfiles otree_tags %}

{% block title %}
  Review Questions
{% endblock %}

{% block content %}

<!-- Hidden session code for JavaScript access -->
<span id="session-code" style="display:none;">{{ session.code }}</span>

<style>
/* Enhanced input box styling */
.otree-form-group input[type="number"],
.otree-form-group input[type="text"] {
    width: 100px !important;
    padding: 8px 10px !important;
    border: 2px solid #ced4da !important;
    border-radius: 6px !important;
    font-size: 0.95em !important;
    text-align: center !important;
    transition: all 0.3s ease !important;
    background-color: #f8f9fa !important;
}

.otree-form-group input[type="number"]:focus,
.otree-form-group input[type="text"]:focus {
    outline: none !important;
    border-color: #007bff !important;
    background-color: white !important;
    box-shadow: 0 0 0 3px rgba(0,123,255,0.1) !important;
}

.otree-form-group input[type="number"]:hover,
.otree-form-group input[type="text"]:hover {
    border-color: #007bff !important;
    background-color: white !important;
}

/* Style the input group to make both containers same height */
.input-group {
    height: 42px !important;
}

.input-group-text {
    padding: 0 12px !important;
    font-size: 1em !important;
    height: 42px !important;
    line-height: 42px !important;
    display: flex !important;
    align-items: center !important;
}

.input-group .form-control {
    height: 42px !important;
}
</style>

    <p>
      You will get 0.4 point for each correct answer.
    </p>
    <h3>Question 1</h3>
    <p>
      Suppose your group members invest 10, 5, 8 points respectively into the group account, and you invest 1 point into the group account.
    </p>

    {% formfield player.question11 label="Your earnings from the group account would be" %}

    {% formfield player.question12 label="Your earnings from the private account would be" %}

    {% formfield player.question13 label="Your total earnings would be" %}

    <h3>Question 2</h3>
    <p>
      Suppose your group members invest 10, 5, 8 points respectively into the group account, and you invest 5 points into the group account.
    </p>

    {% formfield player.question21 label="Your earnings from the group account would be" %}

    {% formfield player.question22 label="Your earnings from the private account would be" %}

    {% formfield player.question23 label="Your total earnings would be" %}

    <h3>Question 3</h3>
    <p>
      Suppose your group members invest 10, 5, 8 points respectively into the group account, and you invest 10 points into the group account.
    </p>

    {% formfield player.question31 label="Your earnings from the group account would be" %}

    {% formfield player.question32 label="Your earnings from the private account would be" %}

    {% formfield player.question33 label="Your total earnings would be" %}

    <h3>Question 4</h3>
    <p>
      Your group members invested 2, 4, 6 points respectively. How much should you invest to maximize your total earnings?
    </p>
    {% formfield player.question4 label="You should invest" %}

    <h3>Question 5</h3>
    <p>
      Your group members invested 8, 4, 1 points respectively. How much should you invest to maximize your total earnings?
    </p>
    {% formfield player.question5 label="You should invest" %}

    <h3>Question 6</h3>
    <p>
      Your group members invested 4, 4, 4 points respectively. How much should you invest to maximize your total earnings?
    </p>
    {% formfield player.question6 label="You should invest" %}

    <p>
        <strong>Please note that in the real game, you won't know your group members' investments before you make the decision</strong>
    </p>

    <!-- Hidden field to store calculator data for this page -->
    <input type="hidden" name="calc_question" id="id_calc_question" value="">
    <script>
    $(document).ready(function() {
        var participantCode = window.location.pathname.split('/')[2];
        var sessionCode = $('#session-code').text();
        // Match the key format from calculator: calc_question (8 chars)
        var pageKey = 'calc_question_' + sessionCode + '_' + participantCode;

        console.log('[Question Page] Looking for key:', pageKey);

        // Update hidden field before form submission
        $('form').on('submit', function() {
            var logs = localStorage.getItem(pageKey) || '[]';
            $('#id_calc_question').val(logs);
            console.log('[Question] Saving', JSON.parse(logs).length, 'calculator entries');
            console.log('[Question] Data:', logs.substring(0, 200));
        });
    });
    </script>

    {% next_button %}

    {% include 'public_goods_high_four/Instructions_quiz.html' %}

{% endblock %}
